---
layout:     post
title:      多目标系列之一MMOE模型
subtitle:   MMOE模型详解
date:       2017-06-19
author:     BY
header-img: img/post-bg-universe.jpg
catalog: true
tags:
    - 多目标
    - 机器学习
    - MMOE
---

现在客户运营已经离不开多目标了，原先做新闻推荐会关注单纯点击率，现在基本上会关注人均时长或者留存，都是围绕着多目标展开的。

多目标可以从两个维度分，第一个维度是多个目标前后有依赖关系，比如文章推荐或者商品购买推荐，都是有转化漏斗的，需要先点击才能发生阅读时长或者点赞，在商品上就是先点击后购买转化；另一种是前后目标没有依赖关系的，比如抖音沉浸式短视频，点击开就会播放视频，那么产生的指标例如点赞，评论播放时常都是没有先后依赖关系的，我们简称前一种是两阶段或者多阶段多目标优化，后一种为一阶段多目标优化。另一个维度是多目标的任务类型，比如GMV优化中点击率和转化率，都是二分类任务，而时常优化可能涉及点赞率和播放时常，就会有二分类和回归融合。这两个维度不同，在多目标模型设计阶段都需要针对性考虑设计。

MMOE模型是google在2018KDD上发布的，原文[Modeling Task Relationships in Multi-task Learning with Multi-gate Mixture-of-Experts](https://www.kdd.org/kdd2018/accepted-papers/view/modeling-task-relationships-in-multi-task-learning-with-multi-gate-mixture-)。

### 模型简介

依然用我们上面的例子介绍，假设我们优化文章的阅读时长，假设时常只跟单个推荐文章的点击率和阅读时常有关，那么就相当于我们要从这两个指标入手建模。这是一个典型的两阶段、不同类融合多目标的任务。

现在深度模型基本围绕着模型结构和损失函数两块进行创新，MMOE也不例外。


### 模型结构创新

模型结构层面，底层使用经典的Shared-Bottom结构，如下图a中所示，

![模型结构](http://yougth.top/img/ml/MMOE_0.png)


### 损失函数创新
